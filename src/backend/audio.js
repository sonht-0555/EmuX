const audio_batch_cb=(o,e)=>writeAudio(o,e),audio_cb=()=>{};var audioContext,audioWorkletNode,audioGainNode;async function initAudio(o){if(audioContext)return audioContext.resume();audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:48e3,latencyHint:"interactive"}),await audioContext.audioWorklet.addModule("./src/backend/audio-processor.js"),audioWorkletNode=new AudioWorkletNode(audioContext,"audio-processor"),(audioGainNode=audioContext.createGain()).gain.value=0,audioWorkletNode.port.postMessage({ratio:o}),audioWorkletNode.connect(audioGainNode).connect(audioContext.destination);const e=audioContext.resume();return fadeAudioIn(),e}function fadeAudioIn(o=2){if(!audioGainNode||!audioContext)return;const e=audioContext.currentTime;audioGainNode.gain.cancelScheduledValues(e),audioGainNode.gain.setValueAtTime(audioGainNode.gain.value,e),audioGainNode.gain.linearRampToValueAtTime(1,e+o)}function writeAudio(o,e){if(!audioWorkletNode||!isRunning)return e;const i=new Int16Array(Module.HEAPU8.buffer,o,2*e),a=new Float32Array(e),t=new Float32Array(e);for(let o=0;o<e;o++)a[o]=i[2*o]/32768,t[o]=i[2*o+1]/32768;return audioWorkletNode.port.postMessage({l:a,r:t}),e}